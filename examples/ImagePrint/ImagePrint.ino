/*
  Please install the following dependent libraries before compiling:
  M5Atom: https://github.com/m5stack/M5Atom
  FastLED: https://github.com/FastLED/FastLED
*/

#include "PrinterApi.h"
#include <M5Atom.h>

Printer atomPrinter;
HardwareSerial AtomSerial(1);

// https://m5stack.lang-ship.com/tools/image2data/?format=1bit_2
const unsigned char img[128] PROGMEM = {
0b11111111, 0b11111111, 0b11111111, 0b11111111,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000111, 0b00000111, 0b00011111, 0b11000001,
0b10000111, 0b00000111, 0b00010000, 0b00000001,
0b10000111, 0b10000111, 0b00010000, 0b00000001,
0b10000111, 0b10001111, 0b00010000, 0b00000001,
0b10000110, 0b10001011, 0b00011111, 0b00000001,
0b10000110, 0b11011011, 0b00000001, 0b10000001,
0b10000110, 0b01110011, 0b00000000, 0b11000001,
0b10000110, 0b01110011, 0b00000000, 0b11000001,
0b10000110, 0b00100011, 0b00000000, 0b11000001,
0b10000110, 0b00000011, 0b00000000, 0b11000001,
0b10000110, 0b00000011, 0b00100001, 0b10000001,
0b10000110, 0b00000011, 0b00011111, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b10000000, 0b00000000, 0b00000000, 0b00000001,
0b11111111, 0b11111111, 0b11111111, 0b11111111,
};

void setup() {
  M5.begin(true, false, true);

  atomPrinter.Set_Printer_Uart(AtomSerial, 23, 33, 9600);
  atomPrinter.Printer_Init();
  atomPrinter.NewLine_Setting(0x0A);
}

void loop() {
  atomPrinter.Printer_Init();
  atomPrinter.Print_ASCII("Hello M5stack");
  atomPrinter.Print_NewLine(2);
  atomPrinter.Printer_Init();
  atomPrinter.Print_BMP(32, 32, img);
  atomPrinter.Print_NewLine(3);
  atomPrinter.Printer_Init();

  delay(30000);
}
